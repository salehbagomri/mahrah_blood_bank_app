# حل مشكلة الرمز الدولي في أرقام الهاتف

## المشكلة:

```
❌ الأرقام في قاعدة البيانات: +967777123456
❌ المستخدم يُدخل: 777123456
❌ البحث لا يجد المتبرع!
```

---

## الحل:

### 1️⃣ دالة بحث ذكية تدعم جميع الأشكال:

```dart
البحث يدعم:
✅ 777123456
✅ +967777123456
✅ 967777123456
✅ 00967777123456
✅ 0777123456
```

### 2️⃣ كيف يعمل:

```
1. تنظيف الرقم (إزالة المسافات والشرطات)
2. البحث بالرقم كما هو
3. إذا لم يجد، يضيف +967 ويبحث
4. إذا لم يجد، يحذف الصفر الأول ويبحث
5. يجد المتبرع! ✅
```

---

## الاستخدام:

```dart
// المستخدم يُدخل أي شكل:
await findDonorByPhone('777123456');     // ✅ يجد
await findDonorByPhone('+967777123456'); // ✅ يجد
await findDonorByPhone('0777123456');    // ✅ يجد
```

---

## خطوات التطبيق:

### 1. نفّذ في Supabase:
```
fix_reports_rls.sql
```

### 2. الكود تم تحديثه:
```
✅ lib/services/donor_service.dart
✅ lib/screens/reports/report_donor_screen.dart
```

### 3. جرب:
```
1. افتح شاشة الإبلاغ
2. أدخل رقم بأي شكل
3. يجب أن يعمل!
```

---

## RLS Policy Fix:

```sql
-- السماح للجميع بإضافة بلاغات
CREATE POLICY "reports_insert_policy"
ON public.reports
FOR INSERT
TO authenticated
WITH CHECK (true);
```

---

**تم حل المشكلتين! ✅**

